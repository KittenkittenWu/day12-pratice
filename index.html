<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å¦™éº—æ­²æ•¸è¨ˆç®—æ©Ÿ</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;800&display=swap');
    body {
      font-family: 'Inter', sans-serif;
    }
  </style>
  
<!--  æ”¾å…¥é€™ä¸‰è¡Œé–‹å§‹ -->
<link rel="icon" type="image/png" href="./icon.png">
<link rel="apple-touch-icon" href="./icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="./icon.png">
<!--  æ”¾å…¥é€™ä¸‰è¡ŒçµæŸ -->

</head>

<body class="bg-[#F4EEFF] min-h-screen flex items-center justify-center p-4">

  <div class="bg-white rounded-2xl shadow-xl p-8 max-w-md w-full">

    <div class="w-24 h-24 mx-auto mb-4 flex items-center justify-center text-6xl">
      ğŸ¶
    </div>

    <h1 class="text-3xl font-bold text-center text-[#424874] mb-6">
      å¦™éº—æ­²æ•¸è¨ˆç®—æ©Ÿ
    </h1>

    <div class="mb-4">
      <label for="birthday" class="block text-sm font-medium text-[#424874] mb-2">
        è«‹é¸æ“‡å¦™éº—çš„ç”Ÿæ—¥ï¼š
      </label>
      <input
        type="date"
        id="birthday"
        value="2023-02-28"
        class="w-full p-3 border border-[#A6B1E1] rounded-lg bg-[#F4EEFF] text-[#424874] focus:outline-none focus:ring-2 focus:ring-[#424874] focus:border-transparent transition"
      />
    </div>

    <button
      id="calcBtn"
      class="w-full p-3 bg-[#A6B1E1] text-white font-bold rounded-lg hover:bg-[#424874] transition-colors duration-300 transform hover:scale-105"
    >
      é–‹å§‹è¨ˆç®—
    </button>

    <div
      id="result"
      class="mt-6 p-4 bg-[#F4EEFF] rounded-lg text-[#424874] text-center min-h-[90px] flex items-center justify-center"
      style="font-size: 1.1em; line-height: 1.6;"
    >
      è«‹é¸æ“‡æ—¥æœŸä¸¦é»æ“ŠæŒ‰éˆ•
    </div>

  </div>

  <script>
    /* === è¨ˆç®—é‚è¼¯ï¼ˆæœªè®Šå‹•ï¼‰ === */

    function calcDogAgeInYears(birthDate) {
      const today = new Date();
      const diffMs = today - birthDate;
      const diffDays = diffMs / (1000 * 60 * 60 * 24);
      return diffDays / 365.25;
    }

    function dogYearsToHumanYears(dogYears) {
      if (dogYears <= 0) return 0;
      if (dogYears <= 1) return dogYears * 15;
      else if (dogYears <= 2) return 15 + (dogYears - 1) * 9;
      else return 24 + (dogYears - 2) * 5;
    }

    /* === æ–°å¢ï¼šå•Ÿå‹•æ™‚è®€å– localStorage çš„è³‡æ–™ === */
    window.addEventListener('DOMContentLoaded', () => {
      const lastResult = localStorage.getItem('ml_result_html');
      const lastBirthday = localStorage.getItem('ml_birthday');

      if (lastBirthday) {
        document.getElementById('birthday').value = lastBirthday;
      }

      if (lastResult) {
        document.getElementById('result').innerHTML = lastResult;
      }
    });

    /* === æŒ‰éˆ•è¨ˆç®— === */
    document.getElementById('calcBtn').addEventListener('click', function () {
      const dateStr = document.getElementById('birthday').value;

      if (!dateStr) {
        document.getElementById('result').innerText = 'è«‹å…ˆé¸æ“‡ç”Ÿæ—¥æ—¥æœŸã€‚';
        return;
      }

      const [year, month, day] = dateStr.split('-').map(Number);
      const birthDate = new Date(year, month - 1, day);
      const today = new Date();

      if (birthDate > today) {
        document.getElementById('result').innerText = 'ç”Ÿæ—¥ä¸èƒ½é¸æ“‡æœªä¾†çš„æ—¥æœŸå–”ï¼';
        return;
      }

      const dogAgeYears = calcDogAgeInYears(birthDate);
      const humanAge = dogYearsToHumanYears(dogAgeYears);

      const resultHTML = `
        <div class="text-center">
          å¦™éº—ç¾åœ¨å¤§ç´„ <strong>${dogAgeYears.toFixed(1)}</strong> æ­²ç‹—å¹´é½¡ï¼Œ<br>
          æ›ç®—æˆäººé¡å¹´é½¡å¤§ç´„æ˜¯ <strong>${humanAge.toFixed(1)}</strong> æ­²ã€‚
        </div>
      `;

      const resultDiv = document.getElementById('result');
      resultDiv.innerHTML = resultHTML;

      /* === æ–°å¢ï¼šæŠŠçµæœå¯«é€² localStorage === */
      localStorage.setItem('ml_result_html', resultHTML);
      localStorage.setItem('ml_birthday', dateStr);
    });
  </script>
</body>
</html>
